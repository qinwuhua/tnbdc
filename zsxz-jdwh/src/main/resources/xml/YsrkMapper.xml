<?xml version='1.0' encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hdsx.jdwh.mapper.YsrkMapper">
    <resultMap type="com.hdsx.jdwh.entity.Ysrk" id="ysrk">
        <result column="ID" property="id"/>
        <result column="djbh" property="djbh"/>
        <result column="ywqj" property="ywqj"/>
        <result column="rklx" property="rklx"/>
        <result column="ckmc" property="ckmc"/>
        <result column="wxdh" property="wxdh"/>
        <result column="ysfs" property="ysfs"/>
        <result column="ysr" property="ysr"/>
        <result column="cght" property="cght"/>
        <result column="gysmc" property="gysmc"/>
        <result column="rksm" property="rksm"/>
        <result column="rkjehj" property="rkjehj"/>
        <result column="BZ" property="bz"/>
        <result column="TBR" property="tbr"/>
        <result column="TBSJ" property="tbsj"/>
        <result column="TBDW" property="tbdw"/>
        <result column="TBBM" property="tbbm"/>
        <result column="TBDWDM" property="tbdwdm"/>
        <result column="cghtbh" property="cghtbh"/>
        <collection property="mx" ofType="com.hdsx.jdwh.entity.Ysrkmx" select="getYsrkmxByPdjbh" column="djbh" >
        </collection>

    </resultMap>

    <select id="getYsrkmxByPdjbh" parameterType="string" resultType="com.hdsx.jdwh.entity.Ysrkmx">
        select * from jdwx_bj_rkmx where rkdjbh=#{value}
    </select>

    <select id="getCkInfo" parameterType="hashmap" resultType="hashmap">
        select * from jdwx_bj_ck
    </select>

    <select id="getWxdhInfo" parameterType="hashmap" resultType="hashmap">
        select djbh,sbmc from jdwh_gzbx
    </select>

    <select id="getHtBjInfo" parameterType="hashmap" resultType="hashmap">
        select zmht_zmh bjbh,zmht_zmmc bjmc,zmht_sl rksl,zmht_jldw jldw,' ' ggxh from lsb_zmht where zmht_htbh=#{htbh}
    </select>

    <select id="getWxBjInfo" parameterType="hashmap" resultType="hashmap">
        select ' ' bjbh,sbmc bjmc,' ' rksl,' ' jldw,' ' ggxh from jdwh_gzbx where djbh=#{wxdh}
    </select>

    <insert id="addYsrk" parameterType="com.hdsx.jdwh.entity.Ysrk">
        insert into jdwh_bj_ysrk
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="id != null" >id,</if>
            <if test="djbh != null" >djbh,</if>
            <if test="ywqj != null" >ywqj,</if>
            <if test="rklx != null" >rklx,</if>
            <if test="ckmc != null" >ckmc,</if>
            <if test="wxdh != null" >wxdh,</if>
            <if test="ysfs != null" >ysfs,</if>
            <if test="ysr != null" >ysr,</if>
            <if test="cght != null" >cght,</if>
            <if test="gysmc != null" >gysmc,</if>
            <if test="rksm != null" >rksm,</if>
            <if test="rkjehj != null" >rkjehj,</if>
            <if test="bz != null" >bz,</if>
            <if test="tbr != null" >tbr,</if>
            <if test="tbsj != null" >tbsj,</if>
            <if test="tbdw != null" >tbdw,</if>
            <if test="tbbm != null" >tbbm,</if>
            <if test="tbdwdm != null" >tbdwdm,</if>
            <if test="cghtbh != null" >cghtbh,</if>

        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="id != null" >#{id},</if>
            <if test="djbh != null" >#{djbh},</if>
            <if test="ywqj != null" >#{ywqj},</if>
            <if test="rklx != null" >#{rklx},</if>
            <if test="ckmc != null" >#{ckmc},</if>
            <if test="wxdh != null" >#{wxdh},</if>
            <if test="ysfs != null" >#{ysfs},</if>
            <if test="ysr != null" >#{ysr},</if>
            <if test="cght != null" >#{cght},</if>
            <if test="gysmc != null" >#{gysmc},</if>
            <if test="rksm != null" >#{rksm},</if>
            <if test="rkjehj != null" >#{rkjehj},</if>
            <if test="bz != null" >#{bz},</if>
            <if test="tbr != null" >#{tbr},</if>
            <if test="tbsj != null" >#{tbsj},</if>
            <if test="tbdw != null" >#{tbdw},</if>
            <if test="tbbm != null" >#{tbbm},</if>
            <if test="tbdwdm != null" >#{tbdwdm},</if>
            <if test="cghtbh != null" >#{cghtbh},</if>
        </trim>
    </insert>

    <insert id="addYsrkMx" parameterType="com.hdsx.jdwh.entity.Ysrk">
        begin
        <foreach collection="mx" item="item" index="index" separator=";">
            insert into JDWX_BJ_RKMX (ID, RKDJBH, XH, BJMC, BJBH, GGXH, JLDW, RKSL, RKDJ, RKJE, BJZT, BZ)  values
            (sys_guid(),trim(#{djbh,jdbcType=VARCHAR}),trim(#{item.xh,jdbcType=VARCHAR}),trim(#{item.bjmc,jdbcType=VARCHAR}),trim(#{item.bjbh,jdbcType=VARCHAR}),trim(#{item.ggxh,jdbcType=VARCHAR}),trim(#{item.jldw,jdbcType=VARCHAR}),trim(#{item.rksl,jdbcType=VARCHAR}),trim(#{item.rkdj,jdbcType=VARCHAR}),trim(#{item.rkje,jdbcType=VARCHAR}),trim(#{item.bjzt,jdbcType=VARCHAR}),trim(#{item.bz,jdbcType=VARCHAR}))
        </foreach>
        ;end;
    </insert>

    <update id="editYsrk" parameterType="com.hdsx.jdwh.entity.Ysrk" >
        update jdwh_bj_ysrk
        <set>
            <if test="id != null" >id=#{id},</if>
            <if test="djbh != null" >djbh=#{djbh},</if>
            <if test="ywqj != null" >ywqj=#{ywqj},</if>
            <if test="rklx != null" >rklx=#{rklx},</if>
            <if test="ckmc != null" >ckmc=#{ckmc},</if>
            <if test="wxdh != null" >wxdh=#{wxdh},</if>
            <if test="ysfs != null" >ysfs=#{ysfs},</if>
            <if test="ysr != null" >ysr=#{ysr},</if>
            <if test="cght != null" >cght=#{cght},</if>
            <if test="gysmc != null" >gysmc=#{gysmc},</if>
            <if test="rksm != null" >rksm=#{rksm},</if>
            <if test="rkjehj != null" >rkjehj=#{rkjehj},</if>
            <if test="bz != null" >bz=#{bz},</if>
            <if test="tbr != null" >tbr=#{tbr},</if>
            <if test="tbsj != null" >tbsj=#{tbsj},</if>
            <if test="tbdw != null" >tbdw=#{tbdw},</if>
            <if test="tbbm != null" >tbbm=#{tbbm},</if>
            <if test="tbdwdm != null" >tbdwdm=#{tbdwdm},</if>
            <if test="cghtbh != null" >cghtbh=#{cghtbh},</if>
        </set>
        where 1=1 and djbh=#{djbh}
    </update>
    <delete id="delYsrkMx" parameterType="com.hdsx.jdwh.entity.Ysrk">
        delete from JDWX_BJ_RKMX where rkdjbh=#{djbh}
    </delete>

    <delete id="delYsrkBydjbhs" parameterType="java.util.List" >
        delete from jdwh_bj_ysrk
        where djbh in
        <foreach collection="list" item="id"  open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <delete id="delYsrkMxBydjbhs" parameterType="java.util.List" >
        delete from JDWX_BJ_RKMX
        where rkdjbh in
        <foreach collection="list" item="id"  open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <select id="getYsrkInfoByDjbh" parameterType="string" resultMap="ysrk">
        select * from jdwh_bj_ysrk zb
        where zb.djbh=#{value}
    </select>

    <select id="getYsrkList" parameterType="hashmap" resultMap="ysrk">
        select * from jdwh_bj_ysrk zb
        where 1=1
        <if test="tbdwdm !=null and tbdwdm !=''">and zb.tbdwdm like #{tbdwdm}||'%'</if>
        <if test="rklx !=null and rklx !=''">and zb.rklx like #{rklx}||'%'</if>
    </select>

    <!--



    





    <select id="getYsrkmxByPid" resultType="com.hdsx.jdwh.entity.Ysrkmx" parameterType="string">
        select * from JDWH_RCXJ_JCMX mx where mx.mx_pid=#{mx_pid}
    </select>-->


</mapper>