<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.zxyh.mapper.BgglGcbgMapper">

    <insert id="addBgsqbForBggl" parameterType="com.hdsx.zxyh.entity.Bgglbgsqb">
        insert into ZXYH_GCBGSQB
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="djbh != null" >djbh,</if>
            <if test="gcmc != null" >gcmc,</if>
            <if test="sbdw != null" >sbdw,</if>
            <if test="htbh != null" >htbh,</if>
            <if test="zh != null" >zh,</if>
            <if test="gldw != null" >gldw,</if>
            <if test="bgyy != null" >bgyy,</if>
            <if test="bgnrjfa != null" >bgnrjfa,</if>
            <if test="bgys != null" >bgys,</if>
            <if test="bzdw != null" >bzdw,</if>
            <if test="bzrq != null" >bzrq,</if>
            <if test="bzdwbh != null" >bzdwbh,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="djbh != null" >#{djbh},</if>
            <if test="gcmc != null" >#{gcmc},</if>
            <if test="sbdw != null" >#{sbdw},</if>
            <if test="htbh != null" >#{htbh},</if>
            <if test="zh != null" >#{zh},</if>
            <if test="gldw != null" >#{gldw},</if>
            <if test="bgyy != null" >#{bgyy},</if>
            <if test="bgnrjfa != null" >#{bgnrjfa},</if>
            <if test="bgys != null" >#{bgys},</if>
            <if test="bzdw != null" >#{bzdw},</if>
            <if test="bzrq != null" >#{bzrq},</if>
            <if test="bzdwbh != null" >#{bzdwbh},</if>
        </trim>
    </insert>

    <update id="editBgsqbForBggl" parameterType="com.hdsx.zxyh.entity.Bgglbgsqb" >
        update ZXYH_GCBGSQB
        <set>
            <if test="djbh != null" >djbh=#{djbh},</if>
            <if test="gcmc != null" >gcmc=#{gcmc},</if>
            <if test="sbdw != null" >sbdw=#{sbdw},</if>
            <if test="htbh != null" >htbh=#{htbh},</if>
            <if test="zh != null" >zh=#{zh},</if>
            <if test="gldw != null" >gldw=#{gldw},</if>
            <if test="bgyy != null" >bgyy=#{bgyy},</if>
            <if test="bgnrjfa != null" >bgnrjfa=#{bgnrjfa},</if>
            <if test="bgys != null" >bgys=#{bgys},</if>
            <if test="bzdw != null" >bzdw=#{bzdw},</if>
            <if test="bzrq != null" >bzrq=#{bzrq},</if>
            <if test="bzdwbh != null" >bzdwbh=#{bzdwbh},</if>
        </set>
        where 1=1 and djbh=#{djbh}
    </update>


    <delete id="delBgsqbForBggl" parameterType="java.util.List" >
        delete from ZXYH_GCBGSQB
        where djbh in
        <foreach collection="list" item="id"  open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <select id="getBgsqbInfoByDjbh" parameterType="string" resultType="com.hdsx.zxyh.entity.Bgglbgsqb">
        select g.*
        from ZXYH_GCBGSQB g where djbh=#{value}
    </select>

    <select id="getBgsqbList" parameterType="hashmap" resultType="com.hdsx.zxyh.entity.Bgglbgsqb">
        select g.*
        from ZXYH_GCBGSQB g where 1=1
        <if test="dwbh != null and dwbh != ''">
            and g.BZDWBH=#{dwbh}
        </if>
        <if test="htbh != null and htbh != ''">
            and g.htbh=#{htbh}
        </if>
        <if test="ksrq != null and ksrq != ''">
            and to_date(BZRQ,'yyyy/mm/dd')>=to_date(#{ksrq},'yyyy/mm/dd')
        </if>
        <if test="jsrq != null and jsrq != ''">
            and to_date(BZRQ,'yyyy/mm/dd')&lt;=to_date(#{jsrq},'yyyy/mm/dd')
        </if>
    </select>

    <update id="spBgsqbForBggl" parameterType="hashmap">
        update ZXYH_GCBGSQB set spzt=#{spzt}
        where djbh in
        <foreach collection="djbhs" item="id"  open="(" separator="," close=")">
            #{id}
        </foreach>
    </update>

    <select id="getBglBgsqbInfo" resultType="com.hdsx.zxyh.entity.Bgglbgl">
        select t.gcmc,t.zh,t.bgnrjfa bgnr,t.djbh SQBBH,t.htbh  from  Zxyh_Gcbgsqb t where t.spzt='已下发'
    </select>


    <insert id="addBglForBggl" parameterType="com.hdsx.zxyh.entity.Bgglbgl">
        insert into ZXYH_GCBGL
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="bglbh != null" >bglbh,</if>
            <if test="gcmc != null" >gcmc,</if>
            <if test="zh != null" >zh,</if>
            <if test="bw != null" >bw,</if>
            <if test="ysjtmc != null" >ysjtmc,</if>
            <if test="yth != null" >yth,</if>
            <if test="bgsjtmc != null" >bgsjtmc,</if>
            <if test="bgth != null" >bgth,</if>
            <if test="sqbbh != null" >sqbbh,</if>
            <if test="bgnr != null" >bgnr,</if>
            <if test="cbdw != null" >cbdw,</if>
            <if test="cbdwbh != null" >cbdwbh,</if>
            <if test="bzrq != null" >bzrq,</if>
            <if test="htbh != null" >htbh,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="bglbh != null" >#{bglbh},</if>
            <if test="gcmc != null" >#{gcmc},</if>
            <if test="zh != null" >#{zh},</if>
            <if test="bw != null" >#{bw},</if>
            <if test="ysjtmc != null" >#{ysjtmc},</if>
            <if test="yth != null" >#{yth},</if>
            <if test="bgsjtmc != null" >#{bgsjtmc},</if>
            <if test="bgth != null" >#{bgth},</if>
            <if test="sqbbh != null" >#{sqbbh},</if>
            <if test="bgnr != null" >#{bgnr},</if>
            <if test="cbdw != null" >#{cbdw},</if>
            <if test="cbdwbh != null" >#{cbdwbh},</if>
            <if test="bzrq != null" >#{bzrq},</if>
            <if test="htbh != null" >#{htbh},</if>
        </trim>
    </insert>

    <update id="editBglForBggl" parameterType="com.hdsx.zxyh.entity.Bgglbgl" >
        update ZXYH_GCBGL
        <set>
            <if test="bglbh != null" >bglbh=#{bglbh},</if>
            <if test="gcmc != null" >gcmc=#{gcmc},</if>
            <if test="zh != null" >zh=#{zh},</if>
            <if test="bw != null" >bw=#{bw},</if>
            <if test="ysjtmc != null" >ysjtmc=#{ysjtmc},</if>
            <if test="yth != null" >yth=#{yth},</if>
            <if test="bgsjtmc != null" >bgsjtmc=#{bgsjtmc},</if>
            <if test="bgth != null" >bgth=#{bgth},</if>
            <if test="sqbbh != null" >sqbbh=#{sqbbh},</if>
            <if test="bgnr != null" >bgnr=#{bgnr},</if>
            <if test="cbdw != null" >cbdw=#{cbdw},</if>
            <if test="cbdwbh != null" >cbdwbh=#{cbdwbh},</if>
            <if test="bzrq != null" >bzrq=#{bzrq},</if>
            <if test="htbh != null" >htbh=#{htbh},</if>
        </set>
        where 1=1 and bglbh=#{bglbh}
    </update>


    <delete id="delBglForBggl" parameterType="java.util.List" >
        delete from ZXYH_GCBGL
        where bglbh in
        <foreach collection="list" item="id"  open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <select id="getBglInfoByBglbh" parameterType="string" resultType="com.hdsx.zxyh.entity.Bgglbgl">
        select g.*
        from ZXYH_GCBGL g where bglbh=#{value}
    </select>

    <select id="getBglList" parameterType="hashmap" resultType="com.hdsx.zxyh.entity.Bgglbgl">
        select g.*
        from ZXYH_GCBGL g where 1=1
        <if test="dwbh != null and dwbh != ''">
            and g.CBDWBH=#{dwbh}
        </if>
        <if test="htbh != null and htbh != ''">
            and g.htbh=#{htbh}
        </if>
        <if test="ksrq != null and ksrq != ''">
            and to_date(BZRQ,'yyyy/mm/dd')>=to_date(#{ksrq},'yyyy/mm/dd')
        </if>
        <if test="jsrq != null and jsrq != ''">
            and to_date(BZRQ,'yyyy/mm/dd')&lt;=to_date(#{jsrq},'yyyy/mm/dd')
        </if>
    </select>

    <update id="spBglForBggl" parameterType="hashmap">
        update ZXYH_GCBGL set spzt=#{spzt}
        where bglbh in
        <foreach collection="djbhs" item="id"  open="(" separator="," close=")">
            #{id}
        </foreach>
    </update>

</mapper>