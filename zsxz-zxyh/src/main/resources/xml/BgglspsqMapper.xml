<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.zxyh.mapper.BgglspsqMapper">

    <!-- 查询索赔申请单列表数据 -->
    <select id="getSpsqdList" parameterType="hashmap" resultType="com.hdsx.zxyh.entity.Bgglspsqs">
        select g.PMMTGCSPSQS_ID,g.PMMTGCSPSQS_DWMC,g.PMMTGCSPSQS_DWBH,g.PMMTGCSPSQS_DWID,g.PMMTGCSPSQS_BMMC,g.PMMTGCSPSQS_BMBH,g.PMMTGCSPSQS_BMID,g.PMMTGCSPSQS_TBR,to_char(g.PMMTGCSPSQS_TBRQ,'yyyy-mm-dd') PMMTGCSPSQS_TBRQ,g.PMMTGCSPSQS_SPZT,g.PMMTGCSPSQS_FILE,g.PMMTGCSPSQS_DJBH,g.PMMTGCSPSQS_CJRQ,g.PMMTGCSPSQS_GCMC,g.PMMTGCSPSQS_HTBH,g.PMMTGCSPSQS_SQJE,g.PMMTGCSPSQS_SPSJ,g.PMMTGCSPSQS_SCYJS,g.PMMTGCSPSQS_SPYJS,g.PMMTGCSPSQS_SPJE,g.PMMTGCSPSQS_CJDW,g.PMMTGCSPSQS_GLDW,to_char(g.PMMTGCSPSQS_SQRQ,'yyyy-mm-dd') PMMTGCSPSQS_SQRQ,g.PMMTGCSPSQS_CBDW,g.PMMTGCSPSQS_SPSJJS
        from ZXYH_GCSPSQS g where 1=1
        <if test="dwbh != null and dwbh != ''">
            and g.PMMTGCSPSQS_DWBH=#{dwbh}
        </if>
        <if test="pmmtgcspsqs_htbh != null and pmmtgcspsqs_htbh != ''">
            and g.pmmtgcspsqs_htbh=#{pmmtgcspsqs_htbh}
        </if>
        <if test="ksrq != null and ksrq != ''">
            and to_date(to_char(g.pmmtgcspsqs_sqrq,'yyyy-mm-dd'),'yyyy-mm-dd')>=to_date(#{ksrq},'yyyy-mm-dd')
        </if>
        <if test="jsrq != null and jsrq != ''">
            and to_date(to_char(g.pmmtgcspsqs_sqrq,'yyyy-mm-dd'),'yyyy-mm-dd')&lt;=to_date(#{jsrq},'yyyy-mm-dd')
        </if>
    </select>

    <!--  添加索赔申请书  -->
    <insert id="addSpsqsForBggl" parameterType="com.hdsx.zxyh.entity.Bgglspsqs">
        insert into ZXYH_GCSPSQS
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="pmmtgcspsqs_djbh != null" >pmmtgcspsqs_djbh,</if>
            <if test="pmmtgcspsqs_gcmc != null" >pmmtgcspsqs_gcmc,</if>
            <if test="pmmtgcspsqs_sqrq != null" >pmmtgcspsqs_sqrq,</if>
            <if test="pmmtgcspsqs_htbh != null" >pmmtgcspsqs_htbh,</if>
            <if test="pmmtgcspsqs_gldw != null" >pmmtgcspsqs_gldw,</if>
            <if test="pmmtgcspsqs_cbdw != null" >pmmtgcspsqs_cbdw,</if>
            <if test="pmmtgcspsqs_spsjjs != null" >pmmtgcspsqs_spsjjs,</if>
            <if test="pmmtgcspsqs_sqje != null" >pmmtgcspsqs_sqje,</if>
            <if test="pmmtgcspsqs_spje != null" >pmmtgcspsqs_spje,</if>
            <if test="pmmtgcspsqs_tbr != null" >pmmtgcspsqs_tbr,</if>
            <if test="pmmtgcspsqs_tbrq != null" >pmmtgcspsqs_tbrq,</if>
            <if test="pmmtgcspsqs_bmmc != null" >pmmtgcspsqs_bmmc,</if>
            <if test="pmmtgcspsqs_dwmc != null" >pmmtgcspsqs_dwmc,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="pmmtgcspsqs_djbh != null" >#{pmmtgcspsqs_djbh},</if>
            <if test="pmmtgcspsqs_gcmc != null" >#{pmmtgcspsqs_gcmc},</if>
            <if test="pmmtgcspsqs_sqrq != null" >to_date(#{pmmtgcspsqs_sqrq},'yyyy-mm-dd'),</if>
            <if test="pmmtgcspsqs_htbh != null" >#{pmmtgcspsqs_htbh},</if>
            <if test="pmmtgcspsqs_gldw != null" >#{pmmtgcspsqs_gldw},</if>
            <if test="pmmtgcspsqs_cbdw != null" >#{pmmtgcspsqs_cbdw},</if>
            <if test="pmmtgcspsqs_spsjjs != null" >#{pmmtgcspsqs_spsjjs},</if>
            <if test="pmmtgcspsqs_sqje != null" >#{pmmtgcspsqs_sqje},</if>
            <if test="pmmtgcspsqs_spje != null" >#{pmmtgcspsqs_spje},</if>
            <if test="pmmtgcspsqs_tbr != null" >#{pmmtgcspsqs_tbr},</if>
            <if test="pmmtgcspsqs_tbrq != null" >to_date(#{pmmtgcspsqs_tbrq},'yyyy-mm-dd'),</if>
            <if test="pmmtgcspsqs_bmmc != null" >#{pmmtgcspsqs_bmmc},</if>
            <if test="pmmtgcspsqs_dwmc != null" >#{pmmtgcspsqs_dwmc},</if>
        </trim>
    </insert>

    <!--  编辑索赔申请书  -->
    <update id="editSpsqsForBggl" parameterType="com.hdsx.zxyh.entity.Bgglspsqs" >
        update ZXYH_GCSPSQS
        <set>
            <if test="pmmtgcspsqs_gcmc != null" >pmmtgcspsqs_gcmc=#{pmmtgcspsqs_gcmc},</if>
            <if test="pmmtgcspsqs_sqrq != null" >pmmtgcspsqs_sqrq=to_date(#{pmmtgcspsqs_sqrq},'yyyy-mm-dd'),</if>
            <if test="pmmtgcspsqs_htbh != null" >pmmtgcspsqs_htbh=#{pmmtgcspsqs_htbh},</if>
            <if test="pmmtgcspsqs_gldw != null" >pmmtgcspsqs_gldw=#{pmmtgcspsqs_gldw},</if>
            <if test="pmmtgcspsqs_cbdw != null" >pmmtgcspsqs_cbdw=#{pmmtgcspsqs_cbdw},</if>
            <if test="pmmtgcspsqs_spsjjs != null" >pmmtgcspsqs_spsjjs=#{pmmtgcspsqs_spsjjs},</if>
            <if test="pmmtgcspsqs_sqje != null" >pmmtgcspsqs_sqje=#{pmmtgcspsqs_sqje},</if>
            <if test="pmmtgcspsqs_spje != null" >pmmtgcspsqs_spje=#{pmmtgcspsqs_spje},</if>
            <if test="pmmtgcspsqs_tbr != null" >pmmtgcspsqs_tbr=#{pmmtgcspsqs_tbr},</if>
            <if test="pmmtgcspsqs_tbrq != null" >pmmtgcspsqs_tbrq=to_date(#{pmmtgcspsqs_tbrq},'yyyy-mm-dd'),</if>
            <if test="pmmtgcspsqs_bmmc != null" >pmmtgcspsqs_bmmc=#{pmmtgcspsqs_bmmc},</if>
            <if test="pmmtgcspsqs_dwmc != null" >pmmtgcspsqs_dwmc=#{pmmtgcspsqs_dwmc},</if>
        </set>
        where 1=1 and pmmtgcspsqs_djbh=#{pmmtgcspsqs_djbh}
    </update>

    <!--  删除索赔申请书  -->
    <delete id="delSpsqsForBggl" parameterType="java.util.List" >
        delete from ZXYH_GCSPSQS
        where pmmtgcspsqs_djbh in
        <foreach collection="list" item="id"  open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <!--  通过单据编号查询索赔申请书  -->
    <select id="getSpsqsInfoByDjbh" parameterType="string" resultType="com.hdsx.zxyh.entity.Bgglspsqs">
        select g.PMMTGCSPSQS_ID,g.PMMTGCSPSQS_DWMC,g.PMMTGCSPSQS_DWBH,g.PMMTGCSPSQS_DWID,g.PMMTGCSPSQS_BMMC,g.PMMTGCSPSQS_BMBH,g.PMMTGCSPSQS_BMID,g.PMMTGCSPSQS_TBR,to_char(g.PMMTGCSPSQS_TBRQ,'yyyy-mm-dd') PMMTGCSPSQS_TBRQ,g.PMMTGCSPSQS_SPZT,g.PMMTGCSPSQS_FILE,g.PMMTGCSPSQS_DJBH,g.PMMTGCSPSQS_CJRQ,g.PMMTGCSPSQS_GCMC,g.PMMTGCSPSQS_HTBH,g.PMMTGCSPSQS_SQJE,g.PMMTGCSPSQS_SPSJ,g.PMMTGCSPSQS_SCYJS,g.PMMTGCSPSQS_SPYJS,g.PMMTGCSPSQS_SPJE,g.PMMTGCSPSQS_CJDW,g.PMMTGCSPSQS_GLDW,to_char(g.PMMTGCSPSQS_SQRQ,'yyyy-mm-dd') PMMTGCSPSQS_SQRQ,g.PMMTGCSPSQS_CBDW,g.PMMTGCSPSQS_SPSJJS
        from GCSPSQS g where pmmtgcspsqs_djbh=#{value}
    </select>

    <update id="spSpsqsForBggl" parameterType="hashmap">
        update ZXYH_GCSPSQS set PMMTGCSPSQS_SPZT=#{spzt}
        where PMMTGCSPSQS_DJBH in
        <foreach collection="djbhs" item="id"  open="(" separator="," close=")">
            #{id}
        </foreach>
    </update>

</mapper>